version: 1
job:
  type: "ingestion"
  tags:
  - "epsdl_plp"
  description: "Sync databricks and synapse"
source:
  endpoint: "lo_delta_tables"
  properties:
    query: "select\nrej_sri_expected_call_da.vessel_code,\nrej_sri_expected_call_da.exp_ref,\nrej_sri_expected_call_da.agent_code,\nrej_sri_expected_call_da.port_name,\nrej_sri_expected_call_da.eta,\nrej_sri_expected_call_da.currency,\nrej_sri_expected_call_da.rate,\nrej_sri_expected_call_da.initial_journal_company,\nrej_sri_expected_call_da.initial_journal_series,\nrej_sri_expected_call_da.initial_journal_number,\nrej_sri_expected_call_da.initial_journal_date,\nrej_sri_expected_call_da.second_journal_company,\nrej_sri_expected_call_da.second_journal_series,\nrej_sri_expected_call_da.second_journal_number,\nrej_sri_expected_call_da.second_journal_date,\nrej_sri_expected_call_da.final_journal_company,\nrej_sri_expected_call_da.final_journal_series,\nrej_sri_expected_call_da.final_journal_number,\nrej_sri_expected_call_da.final_journal_date,\nrej_sri_expected_call_da.received_by_user,\nrej_sri_expected_call_da.received_date,\nrej_sri_expected_call_da.checked_by_user,\nrej_sri_expected_call_da.checked_date,\nrej_sri_expected_call_da.rate_flag,\nrej_sri_expected_call_da.matching_company,\nrej_sri_expected_call_da.matching_series,\nrej_sri_expected_call_da.matching_number,\nrej_sri_expected_call_da.agent_relation,\nrej_sri_expected_call_da.berth,\nrej_sri_expected_call_da.action,\nrej_sri_expected_call_da.case_status,\nrej_sri_expected_call_da.serial_no,\nrej_sri_expected_call_da.internal_ref,\nrej_sri_expected_call_da.invoice_date,\nrej_sri_expected_call_da.category,\nrej_sri_expected_call_da.da_comments,\nrej_sri_expected_call_da.cargo,\nrej_sri_expected_call_da.third_journal_company,\nrej_sri_expected_call_da.third_journal_series,\nrej_sri_expected_call_da.third_journal_number,\nrej_sri_expected_call_da.third_journal_date,\nrej_sri_expected_call_da.da_no,\nrej_sri_expected_call_da.given_date,\nrej_sri_expected_call_da.item_remarks,\nrej_sri_expected_call_da.update_user_id,\nrej_sri_expected_call_da.update_date,\nrej_sri_expected_call_da.voyage_number,\nrej_sri_expected_call_da.matching_journal_line,\nrej_sri_expected_call_da.sent_to_diabos,\nrej_sri_expected_call_da.initial_internal_ref,\nrej_sri_expected_call_da.is_general_da,\nrej_sri_expected_call_da.credit_days,\nrej_sri_expected_call_da.payment_method,\nrej_sri_expected_call_da.attachment_code,\nrej_sri_expected_call_da.invoice_date_out,\nrej_sri_expected_call_da.dadesk_daref,\nrej_sri_expected_call_da.sap_document_number,\nrej_sri_expected_call_da.req_serial_no,\nrej_sri_expected_call_da.etd,\nrej_sri_expected_call_da.operating_company,\nrej_sri_expected_call_da.cargo_grade,\nrej_sri_expected_call_da.cargo_grade2,\nrej_sri_expected_call_da.cargo_grade3,\nrej_sri_expected_call_da.cargo_qty2,\nrej_sri_expected_call_da.cargo_qty3,\nrej_sri_expected_call_da.sap_document_number_adv_clrnc,\nrej_sri_expected_call_da.sent_to_dadesk,\nrej_sri_expected_call_da.dadesk_invoiceref,\nrej_sri_expected_call_da.dadesk_invoiceref_second,\nrej_sri_expected_call_da.dadesk_invoiceref_third,\nrej_sri_expected_call_da.dadesk_invoiceref_final,\nrej_sri_expected_call_da.integration_key,\nrej_sri_expected_call_da._validation_error as validation_error,\nrej_sri_expected_call_da.w_source_system,\nrej_sri_expected_call_da.w_src_file_name,\nrej_sri_expected_call_da.w_refresh_ts,\nrej_sri_expected_call_da.w_job_instance_id,\nrej_sri_expected_call_da.w_business_dt,\nrej_sri_expected_call_da.w_location,\nrej_sri_expected_call_da.w_batch_id\nfrom\n${p_epsdl_sri_db}.rej_sri_expected_call_da rej_sri_expected_call_da"
schema:
  strict_schema_check: false
  schema_derivation_strategy: "source"
  discard: false
  columns: []
target:
  endpoint: "lo_dataanalytics_azuresynapseanalytics"
  properties:
    table: "${p_epsdl_plp_db}.rej_sri_expected_call_da"
    format_properties:
      write_semantics: "polybase"
      max_str_length: 4000
  operation: "overwrite"
