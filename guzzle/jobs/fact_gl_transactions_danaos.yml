version: 1
job:
  type: "processing"
  tags:
  - "epsdl_fact"
source:
  endpoint: "lo_delta_tables"
  properties:
    sql: "WITH VW_REQUISITIONS\nAS (\n\tSELECT *\n\tFROM ${p_epsdl_sri_db}.sri_requisitions\n\tWHERE line_type IN (\n\t\t\t'O'\n\t\t\t,'SO'\n\t\t\t)\n\t\tOR line_type IS NULL\n\t)\nSELECT *\nFROM (\n\tSELECT DOCUMENTS.document_date\n\t\t,DOCUMENTS.document_type\n\t\t,DOCUMENTS.our_company\n\t\t,DOCUMENTS.from_to\n\t\t,DOCUMENTS.serial_no\n\t\t,DOCUMENTS.issue_date\n\t\t,DOCUMENTS.place\n\t\t,DOCUMENTS.name\n\t\t,DOCUMENTS.due_date\n\t\t,DOCUMENTS.currency\n\t\t,DOCUMENTS.amount\n\t\t,DOCUMENTS.book_value\n\t\t,DOCUMENTS.vat_amount\n\t\t,DOCUMENTS.vat_category\n\t\t,DOCUMENTS.vat_number\n\t\t,DOCUMENTS.inc_exp_category\n\t\t,DOCUMENTS.inc_exp_group\n\t\t,DOCUMENTS.document_subject\n\t\t,DOCUMENTS.document_subsubject\n\t\t,DOCUMENTS.document_category\n\t\t,DOCUMENTS.transaction_type\n\t\t,DOCUMENTS.journal_company\n\t\t,DOCUMENTS.journal_series\n\t\t,DOCUMENTS.journal_number\n\t\t,DOCUMENTS.journal_line\n\t\t,DOCUMENTS.journal_date\n\t\t,DOCUMENTS.journal_status\n\t\t,DOCUMENTS.journal_user\n\t\t,DOCUMENTS.journal_posting\n\t\t,DOCUMENTS.accrued_on_date\n\t\t,DOCUMENTS.accrued_by_user\n\t\t,DOCUMENTS.document_status\n\t\t,DOCUMENTS.created_by_user\n\t\t,DOCUMENTS.finalized_by_user\n\t\t,DOCUMENTS.filed_to\n\t\t,DOCUMENTS.bank\n\t\t,DOCUMENTS.budget\n\t\t,DOCUMENTS.open_item_status\n\t\t,DOCUMENTS.matching_company\n\t\t,DOCUMENTS.matching_series\n\t\t,DOCUMENTS.matching_number\n\t\t,DOCUMENTS.matching_line\n\t\t,DOCUMENTS.debit_credit\n\t\t,DOCUMENTS.remarks\n\t\t,DOCUMENTS.operation_code1\n\t\t,DOCUMENTS.operation_id1\n\t\t,DOCUMENTS.operation_code2\n\t\t,DOCUMENTS.operation_id2\n\t\t,DOCUMENTS.allocation_date_from\n\t\t,DOCUMENTS.allocation_date_to\n\t\t,DOCUMENTS.entry_number\n\t\t,DOCUMENTS.tot_local_debit\n\t\t,DOCUMENTS.tot_local_credit\n\t\t,DOCUMENTS.tot_book_debit\n\t\t,DOCUMENTS.tot_book_credit\n\t\t,DOCUMENTS.flag1\n\t\t,DOCUMENTS.flag2\n\t\t,DOCUMENTS.reporting_amount\n\t\t,DOCUMENTS.set_currency_amount\n\t\t,DOCUMENTS.approval_level\n\t\t,DOCUMENTS.book_value_off\n\t\t,DOCUMENTS.book_debit_off\n\t\t,DOCUMENTS.book_credit_off\n\t\t,DOCUMENTS.pay_flag\n\t\t,DOCUMENTS.prt_flag\n\t\t,DOCUMENTS.accrual_type\n\t\t,DOCUMENTS.entry_rate\n\t\t,DOCUMENTS.bunker_qty\n\t\t,DOCUMENTS.bunker_price\n\t\t,DOCUMENTS.application_code\n\t\t,DOCUMENTS.application_ref\n\t\t,DOCUMENTS.operation_subid_1\n\t\t,DOCUMENTS.operation_subid_2\n\t\t,DOCUMENTS.entry_rate2\n\t\t,DOCUMENTS.book_value2\n\t\t,DOCUMENTS.tot_book_debit2\n\t\t,DOCUMENTS.tot_book_credit2\n\t\t,DOCUMENTS.currency3\n\t\t,DOCUMENTS.entry_rate3\n\t\t,DOCUMENTS.book_value3\n\t\t,DOCUMENTS.tot_book_debit3\n\t\t,DOCUMENTS.tot_book_credit3\n\t\t,DOCUMENTS.team\n\t\t,DOCUMENTS.job_number\n\t\t,DOCUMENTS.vessel_code\n\t\t,DOCUMENTS.ar_type\n\t\t,DOCUMENTS.approved_by\n\t\t,DOCUMENTS.import_status\n\t\t,DOCUMENTS.imported_by\n\t\t,DOCUMENTS.sup_match\n\t\t,DOCUMENTS.journal_user_2\n\t\t,DOCUMENTS.accrued_by_user_2\n\t\t,DOCUMENTS.created_by_user_2\n\t\t,DOCUMENTS.finalized_by_user_2\n\t\t,DOCUMENTS.flag3\n\t\t,DOCUMENTS.order_number\n\t\t,DOCUMENTS.supplier_code\n\t\t,DOCUMENTS.last_updated\n\t\t,'300000002259034' AS ledger_id\n\t\t,DOCUMENTS.db_userid\n\t\t,DOCUMENTS.fx_rate\n\t\t,DOCUMENTS.mc_reference\n\t\t,DOCUMENTS.spot_rate_flag\n\t\t,DOCUMENTS.filed_to3\n\t\t,DOCUMENTS.pay_approval_level\n\t\t,DOCUMENTS.pay_selected\n\t\t,DOCUMENTS.payment_method\n\t\t,DOCUMENTS.withholding_tax_amount\n\t\t,DOCUMENTS.instrument_no\n\t\t,DOCUMENTS.withholding_tax_code\n\t\t,DOCUMENTS.flag4\n\t\t,DOCUMENTS.submission_date\n\t\t,DOCUMENTS.value_date\n\t\t,DOCUMENTS.transaction_cost\n\t\t,DOCUMENTS.accrual_flag\n\t\t,coalesce(VW_REQUISITIONS1.order_code, VW_REQUISITIONS2.order_code, VW_REQUISITIONS3.order_code) AS order_code\n\t\t,coalesce(VW_REQUISITIONS1.document_code, VW_REQUISITIONS2.document_code, VW_REQUISITIONS3.document_code) AS document_code\n\t\t,coalesce(a.INTERNAL_REF, b.INTERNAL_REF, c.INTERNAL_REF, d.INTERNAL_REF) AS internal_ref\n\t\t,row_number() OVER (\n\t\t\tPARTITION BY DOCUMENTS.journal_company\n\t\t\t,DOCUMENTS.journal_series\n\t\t\t,DOCUMENTS.journal_number\n\t\t\t,DOCUMENTS.journal_line\n\t\t\t,DOCUMENTS.w_source_system ORDER BY DOCUMENTS.journal_date\n\t\t\t) AS row_num\n\t\t,coalesce(Dim_gl_company_vessel.company_id, Dim_gl_company.company_id, '0000') AS company_id\n\t\t,coalesce(dim_gl_vessel.vessel_id, '0000') AS vessel_id\n\t\t,coalesce(Dim_gl_service.service_id, '00') AS service_id\n\t\t,coalesce(Dim_gl_account.account_id, '000000') AS account_id\n\t\t,/*Dim_gl_department.department_id*/ '000' AS department_id\n\t\t,coalesce(Dim_gl_intercompany.intercompany_id,'0000') AS intercompany_id\n\t\t,\n\t\t/*Dim_gl_future1.future1_id*/ '000' AS future1_id\n\t\t,\n\t\t/*Dim_gl_future2.future2_id*/ '0000' AS future2_id\n\t\t,\n\t\t/*case when dim_gl_vessel.vessel_code is null then 0 else dim_gl_vessel.vessel_code end as vessel_code,*/\n\t\t/*case when dim_gl_vessel.vessel_code is null then Dim_gl_company.company_code else dim_gl_vessel.owning_entity_codes end as company_code,*/\n\t\t/*company_code~vessel_code~service_code~account_code~department_code~intercompany_code~future1_code~future2_code~w_source_system*/\n\t\tcoalesce(Dim_gl_company_vessel.danaos_co_code, Dim_gl_company.danaos_co_code, '') || '~' || coalesce((\n\t\t\t\tCASE \n\t\t\t\t\tWHEN dim_gl_vessel.vessel_code IS NULL\n\t\t\t\t\t\tTHEN 0\n\t\t\t\t\tELSE dim_gl_vessel.vessel_code\n\t\t\t\t\tEND\n\t\t\t\t), '') || '~' || coalesce(Dim_gl_service.service_code, '') || '~' || coalesce(Dim_gl_account.oracle_natural_account, '') || '~' || '0' || '~' || Dim_gl_intercompany.intercompany_code || '~' || '0' || '~' || '0' || '~' || DOCUMENTS.w_source_system AS code_combination_id\n\t\t,DOCUMENTS.integration_key\n\t\t,DOCUMENTS.narrative AS journal_narrative\n\t\t,DOCUMENTS.journal_reference\n\t\t,DOCUMENTS.journal_id\n\t\t,DOCUMENTS.tot_global_credit\n\t\t,DOCUMENTS.tot_global_debit\n\t\t,DOCUMENTS.w_x_custom\n\t\t,DOCUMENTS.w_job_instance_id\n\t\t,DOCUMENTS.w_refresh_ts\n\t\t,DOCUMENTS.w_curr_rec_flg\n\t\t,DOCUMENTS.w_data_src_id\n\t\t,DOCUMENTS.w_location\n\t\t,DOCUMENTS.w_batch_id\n\t\t,DOCUMENTS.w_business_dt AS business_date\n\t\t,0 AS delete_flag\n\tFROM (\n\t\tSELECT document_date\n\t\t\t,document_type\n\t\t\t,our_company\n\t\t\t,from_to\n\t\t\t,serial_no\n\t\t\t,issue_date\n\t\t\t,place\n\t\t\t,narrative\n\t\t\t,name\n\t\t\t,due_date\n\t\t\t,currency\n\t\t\t,amount\n\t\t\t,book_value\n\t\t\t,vat_amount\n\t\t\t,vat_category\n\t\t\t,vat_number\n\t\t\t,inc_exp_category\n\t\t\t,inc_exp_group\n\t\t\t,document_subject\n\t\t\t,document_subsubject\n\t\t\t,document_category\n\t\t\t,transaction_type\n\t\t\t,journal_company\n\t\t\t,journal_series\n\t\t\t,journal_number\n\t\t\t,journal_line\n\t\t\t,journal_date\n\t\t\t,journal_status\n\t\t\t,journal_user\n\t\t\t,journal_posting\n\t\t\t,accrued_on_date\n\t\t\t,accrued_by_user\n\t\t\t,document_status\n\t\t\t,created_by_user\n\t\t\t,finalized_by_user\n\t\t\t,filed_to\n\t\t\t,bank\n\t\t\t,budget\n\t\t\t,open_item_status\n\t\t\t,matching_company\n\t\t\t,matching_series\n\t\t\t,matching_number\n\t\t\t,matching_line\n\t\t\t,debit_credit\n\t\t\t,remarks\n\t\t\t,operation_code1\n\t\t\t,operation_id1\n\t\t\t,operation_code2\n\t\t\t,operation_id2\n\t\t\t,allocation_date_from\n\t\t\t,allocation_date_to\n\t\t\t,entry_number\n\t\t\t,tot_local_debit\n\t\t\t,tot_local_credit\n\t\t\t,tot_book_debit\n\t\t\t,tot_book_credit\n\t\t\t,flag1\n\t\t\t,flag2\n\t\t\t,reporting_amount\n\t\t\t,set_currency_amount\n\t\t\t,approval_level\n\t\t\t,book_value_off\n\t\t\t,book_debit_off\n\t\t\t,book_credit_off\n\t\t\t,pay_flag\n\t\t\t,prt_flag\n\t\t\t,accrual_type\n\t\t\t,entry_rate\n\t\t\t,bunker_qty\n\t\t\t,bunker_price\n\t\t\t,application_code\n\t\t\t,application_ref\n\t\t\t,operation_subid_1\n\t\t\t,operation_subid_2\n\t\t\t,entry_rate2\n\t\t\t,book_value2\n\t\t\t,tot_book_debit2\n\t\t\t,tot_book_credit2\n\t\t\t,currency3\n\t\t\t,entry_rate3\n\t\t\t,book_value3\n\t\t\t,tot_book_debit3\n\t\t\t,tot_book_credit3\n\t\t\t,team\n\t\t\t,job_number\n\t\t\t,vessel_code\n\t\t\t,ar_type\n\t\t\t,approved_by\n\t\t\t,import_status\n\t\t\t,imported_by\n\t\t\t,sup_match\n\t\t\t,journal_user_2\n\t\t\t,accrued_by_user_2\n\t\t\t,created_by_user_2\n\t\t\t,finalized_by_user_2\n\t\t\t,flag3\n\t\t\t,order_number\n\t\t\t,supplier_code\n\t\t\t,last_updated\n\t\t\t,db_userid\n\t\t\t,fx_rate\n\t\t\t,mc_reference\n\t\t\t,spot_rate_flag\n\t\t\t,filed_to3\n\t\t\t,pay_approval_level\n\t\t\t,pay_selected\n\t\t\t,payment_method\n\t\t\t,withholding_tax_amount\n\t\t\t,instrument_no\n\t\t\t,withholding_tax_code\n\t\t\t,flag4\n\t\t\t,submission_date\n\t\t\t,value_date\n\t\t\t,transaction_cost\n\t\t\t,accrual_flag\n\t\t\t,w_source_system\n\t\t\t,x.JOURNAL_COMPANY || '/' || x.JOURNAL_SERIES || '/' || x.JOURNAL_NUMBER AS Journal_Reference\n\t\t\t,x.journal_company || '~' || x.journal_series || '~' || x.journal_number || '~' || x.journal_line || '~' || x.w_source_system AS journal_id\n\t\t\t,tot_book_credit AS tot_global_credit\n\t\t\t,tot_book_debit AS tot_global_debit\n\t\t\t,substr(x.NARRATIVE, - 15) AS join_cond3\n\t\t\t,integration_key\n\t\t\t,NULL AS w_x_custom\n\t\t\t,w_job_instance_id\n\t\t\t,w_refresh_ts\n\t\t\t,NULL AS w_curr_rec_flg\n\t\t\t,w_source_system AS w_data_src_id\n\t\t\t,w_location\n\t\t\t,w_batch_id\n\t\t\t,w_business_dt\n\t\tFROM ${p_epsdl_sri_db}.sri_documents x\n\t\t) AS DOCUMENTS\n\tLEFT JOIN VW_REQUISITIONS AS VW_REQUISITIONS1 ON DOCUMENTS.ORDER_NUMBER = VW_REQUISITIONS1.ORDER_CODE\n\t\tAND VW_REQUISITIONS1.w_business_dt = '${business_date}'\n\tLEFT JOIN VW_REQUISITIONS AS VW_REQUISITIONS2 ON VW_REQUISITIONS2.JOURNAL_REFERENCE = DOCUMENTS.Journal_Reference\n\t\tAND VW_REQUISITIONS2.w_business_dt = '${business_date}'\n\tLEFT JOIN VW_REQUISITIONS AS VW_REQUISITIONS3 ON VW_REQUISITIONS3.ORDER_CODE = join_cond3\n\t\tAND VW_REQUISITIONS3.w_business_dt = '${business_date}'\n\tLEFT JOIN ${p_epsdl_sri_db}.sri_expected_call_da a ON (DOCUMENTS.JOURNAL_COMPANY || DOCUMENTS.JOURNAL_SERIES || DOCUMENTS.JOURNAL_NUMBER) = (a.INITIAL_JOURNAL_COMPANY || a.INITIAL_JOURNAL_SERIES || a.INITIAL_JOURNAL_NUMBER)\n\t\tAND a.w_business_dt = '${business_date}'\n\tLEFT JOIN ${p_epsdl_sri_db}.sri_expected_call_da b ON DOCUMENTS.JOURNAL_COMPANY || DOCUMENTS.JOURNAL_SERIES || DOCUMENTS.JOURNAL_NUMBER = b.SECOND_JOURNAL_COMPANY || b.SECOND_JOURNAL_SERIES || b.SECOND_JOURNAL_NUMBER\n\t\tAND b.w_business_dt = '${business_date}'\n\tLEFT JOIN ${p_epsdl_sri_db}.sri_expected_call_da c ON DOCUMENTS.JOURNAL_COMPANY || DOCUMENTS.JOURNAL_SERIES || DOCUMENTS.JOURNAL_NUMBER = c.THIRD_JOURNAL_COMPANY || c.THIRD_JOURNAL_SERIES || c.THIRD_JOURNAL_NUMBER\n\t\tAND c.w_business_dt = '${business_date}'\n\tLEFT JOIN ${p_epsdl_sri_db}.sri_expected_call_da d ON DOCUMENTS.JOURNAL_COMPANY || DOCUMENTS.JOURNAL_SERIES || DOCUMENTS.JOURNAL_NUMBER = d.FINAL_JOURNAL_COMPANY || d.FINAL_JOURNAL_SERIES || d.FINAL_JOURNAL_NUMBER\n\t\tAND d.w_business_dt = '${business_date}'\n\tLEFT JOIN ${p_epsdl_db}.dim_gl_account_danaos Dim_gl_account ON Dim_gl_account.ledger_card = DOCUMENTS.FROM_TO\n\t\tAND Dim_gl_account.source_system = DOCUMENTS.w_source_system\n\tLEFT JOIN (select * from ${p_epsdl_db}.dim_gl_vessel where w_data_src_id='MANUAL') dim_gl_vessel ON (\n\t\t\tCASE \n\t\t\t\tWHEN DOCUMENTS.serial_no LIKE 'MTM %'\n\t\t\t\t\tTHEN DOCUMENTS.our_company || left(DOCUMENTS.serial_no, 4)\n\t\t\t\tELSE DOCUMENTS.our_company\n\t\t\t\tEND\n\t\t\t) = dim_gl_vessel.vessel_code\n\tLEFT JOIN (\n\t\tSELECT *\n\t\tFROM ${p_epsdl_db}.dim_gl_company_danaos\n\t\tWHERE databasename IS NOT NULL\n\t\t) Dim_gl_company_vessel ON Dim_gl_company_vessel.child_value = dim_gl_vessel.owning_entity_codes\n\t\tAND coalesce(Dim_gl_company_vessel.databasename, 'default') = DOCUMENTS.w_source_system\n\tLEFT JOIN (\n\t\tSELECT *\n\t\tFROM ${p_epsdl_db}.dim_gl_company_danaos\n\t\tWHERE databasename IS NOT NULL\n\t\t) Dim_gl_company ON Dim_gl_company.danaos_co_code = DOCUMENTS.our_company\n\t\tAND coalesce(Dim_gl_company.databasename, 'default') = DOCUMENTS.w_source_system\n\tLEFT JOIN (select * from ${p_epsdl_db}.Dim_gl_service where w_data_src_id='MANUAL') Dim_gl_service ON Dim_gl_service.service_code = (\n\t\t\tCASE \n\t\t\t\tWHEN DOCUMENTS.operation_code1 = 'T'\n\t\t\t\t\tTHEN 11\n\t\t\t\tWHEN DOCUMENTS.operation_code1 = 'V'\n\t\t\t\t\tTHEN 13\n\t\t\t\tELSE 0\n\t\t\t\tEND\n\t\t\t)\n\tLEFT JOIN ${p_epsdl_db}.dim_gl_intercompany_danaos Dim_gl_intercompany ON Dim_gl_intercompany.ledger_code = Dim_gl_account.ledger_card\n\t\tAND Dim_gl_intercompany.source_system = Dim_gl_account.source_system\n\tWHERE DOCUMENTS.w_business_dt = '${business_date}'\n\t\tAND DOCUMENTS.JOURNAL_SERIES NOT IN (\n\t\t\t'YC'\n\t\t\t,'PD'\n\t\t\t,'QC'\n\t\t\t,'QT'\n\t\t\t)\n\t) x\nWHERE x.row_num = 1\n"
  additional_columns:
  - name: "w_refresh_ts"
    value: "current_timestamp"
  - name: "business_date"
    value: "'${business_date}'"
  - name: "w_job_instance_id"
    value: "${job_instance_id}"
  - name: "w_batch_id"
    value: "${batch_id}"
  - name: "w_location"
    value: "'ALL'"
  - name: "w_source_system"
    value: "'MANUAL'"
  incremental: false
target:
  primary_key_columns:
  - "integration_key"
  operation: "merge"
  soft_delete: false
  properties:
    template: "default"
    table: "${p_epsdl_db}.fact_gl_transactions_danaos"
    post_sql:
    - "merge into ${p_epsdl_db}.fact_gl_transactions_danaos as tgt using ( select distinct yesterday.journal_company,yesterday.journal_Series,yesterday.journal_number,yesterday.journal_line,yesterday.w_source_system,yesterday.journal_date from (select * from ${p_epsdl_sri_db}.sri_documents where date(w_business_dt)=date_sub(current_date(),1) and year(journal_date) in (year(current_date),(year(current_date)-1))) yesterday left join (select * from ${p_epsdl_sri_db}.sri_documents where date(w_business_dt)=current_date()) today on today.journal_company=yesterday.journal_company and today.journal_Series=yesterday.journal_Series and today.journal_number=yesterday.journal_number and today.journal_line=yesterday.journal_line and  today.w_source_system=yesterday.w_source_system where today.journal_company is null ) as src on (src.journal_company=tgt.journal_company and src.journal_Series=tgt.journal_Series and src.journal_number=tgt.journal_number and src.journal_line=tgt.journal_line and  src.w_source_system=tgt.w_data_src_id and year(tgt.journal_date) in (year(current_date),(year(current_date)-1)) ) when matched then update set tgt.delete_flag=1"
    - "update ${p_epsdl_db}.fact_gl_transactions_danaos  set vessel_id=(select vessel_id from ${p_epsdl_db}.dim_gl_vessel where trim(vessel_code)='2067' and w_data_src_id='MANUAL') where vessel_id=(select vessel_id from ${p_epsdl_db}.dim_gl_vessel where trim(vessel_code)='2067MTM' and w_data_src_id='MANUAL') and journal_date >= to_date('2021-01-01', 'yyyy-MM-dd')  and w_data_src_id in ('CUBIC', 'DANAOS', 'PENWOOD', 'QCT')"
    - "update ${p_epsdl_db}.fact_gl_transactions_danaos  set vessel_id=(select vessel_id from ${p_epsdl_db}.dim_gl_vessel where trim(vessel_code)='2158' and w_data_src_id='MANUAL') where vessel_id=(select vessel_id from ${p_epsdl_db}.dim_gl_vessel where trim(vessel_code)='2158MTM' and w_data_src_id='MANUAL') and journal_date >= to_date('2021-01-01', 'yyyy-MM-dd')  and w_data_src_id in ('CUBIC', 'DANAOS', 'PENWOOD', 'QCT')"
    pre_sql:
    - "set spark.sql.autoBroadcastJoinThreshold=-1"
  merge_columns:
  - "accrual_type"
  - "document_date"
  - "document_type"
  - "our_company"
  - "from_to"
  - "serial_no"
  - "issue_date"
  - "place"
  - "name"
  - "due_date"
  - "currency"
  - "amount"
  - "book_value"
  - "vat_amount"
  - "vat_category"
  - "vat_number"
  - "inc_exp_category"
  - "inc_exp_group"
  - "document_subject"
  - "document_subsubject"
  - "document_category"
  - "transaction_type"
  - "journal_date"
  - "journal_status"
  - "journal_user"
  - "journal_posting"
  - "accrued_on_date"
  - "accrued_by_user"
  - "document_status"
  - "created_by_user"
  - "finalized_by_user"
  - "filed_to"
  - "bank"
  - "budget"
  - "open_item_status"
  - "matching_company"
  - "matching_series"
  - "matching_number"
  - "matching_line"
  - "debit_credit"
  - "remarks"
  - "operation_code1"
  - "operation_id1"
  - "operation_code2"
  - "operation_id2"
  - "allocation_date_from"
  - "allocation_date_to"
  - "entry_number"
  - "tot_local_debit"
  - "tot_local_credit"
  - "tot_book_debit"
  - "tot_book_credit"
  - "flag1"
  - "flag2"
  - "reporting_amount"
  - "set_currency_amount"
  - "approval_level"
  - "book_value_off"
  - "book_debit_off"
  - "book_credit_off"
  - "pay_flag"
  - "prt_flag"
  - "entry_rate"
  - "bunker_qty"
  - "bunker_price"
  - "application_code"
  - "application_ref"
  - "operation_subid_1"
  - "operation_subid_2"
  - "entry_rate2"
  - "book_value2"
  - "tot_book_debit2"
  - "tot_book_credit2"
  - "currency3"
  - "entry_rate3"
  - "book_value3"
  - "tot_book_debit3"
  - "tot_book_credit3"
  - "team"
  - "job_number"
  - "vessel_code"
  - "ar_type"
  - "approved_by"
  - "import_status"
  - "imported_by"
  - "sup_match"
  - "journal_user_2"
  - "accrued_by_user_2"
  - "created_by_user_2"
  - "finalized_by_user_2"
  - "flag3"
  - "order_number"
  - "supplier_code"
  - "last_updated"
  - "db_userid"
  - "fx_rate"
  - "mc_reference"
  - "spot_rate_flag"
  - "filed_to3"
  - "pay_approval_level"
  - "pay_selected"
  - "payment_method"
  - "withholding_tax_amount"
  - "instrument_no"
  - "withholding_tax_code"
  - "flag4"
  - "submission_date"
  - "value_date"
  - "transaction_cost"
  - "accrual_flag"
  - "order_code"
  - "document_code"
  - "internal_ref"
  - "company_id"
  - "vessel_id"
  - "service_id"
  - "account_id"
  - "department_id"
  - "intercompany_id"
  - "future1_id"
  - "future2_id"
  - "code_combination_id"
  - "journal_reference"
  - "journal_id"
  - "tot_global_credit"
  - "tot_global_debit"
  - "journal_company"
  - "journal_line"
  - "journal_number"
  - "journal_series"
  - "journal_narrative"
  - "delete_flag"
  - "ledger_id"
  endpoint: "lo_delta_tables"
