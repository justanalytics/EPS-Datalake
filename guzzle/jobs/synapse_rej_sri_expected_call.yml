version: 1
job:
  type: "ingestion"
  tags:
  - "epsdl_plp"
  description: "Sync databricks and synapse"
source:
  endpoint: "lo_delta_tables"
  properties:
    query: "select\nvessel_code,\neta,\nport_name,\ndeclared_y_n,\nowners_agents_code,\ncontact,\ncontact_tel_aoh,\ncharterers_agents_code,\ncontact_c_a,\ncontact_tel_aoh_c_a,\nsubagent,\ncontact_subagent,\ncontact_subagent_tel_aoh,\nport_action,\netd,\ngeneral_comments,\noperation_actions,\ntechnical_actions,\nport_capt_manning_actions,\ninsurance_actions,\nother_actions,\ncreated_on,\ncreator,\nlast_updated,\nupdated_by,\nnotice1_days,\nnotice2_days,\nnotice3_days,\nnotice4_days,\nnotice5_days,\nnotice6_days,\nnotice7_days,\nnotice8_days,\nnotice9_days,\nnotice1_ok,\nnotice2_ok,\nnotice3_ok,\nnotice4_ok,\nnotice5_ok,\nnotice6_ok,\nnotice7_ok,\nnotice8_ok,\nnotice9_ok,\nowners_agents_tel,\nowners_agents_fax,\nowners_agents_tlx,\ncontact_mob_tel,\nreference,\nexp_ref,\nvoy_id,\nsub_voy_no,\nfreight_tax,\nvia_cost,\ninsurance_cost,\nest_days,\nest_rate,\ncanal_expenses,\nextra_days,\nrate_close,\nrate_unit,\nl_d_rate,\ncargo_unit,\ncargo_qty,\ndelays,\nvsl_sea_days,\nfo_cons_delays,\ndo_cons_delays,\nvsl_next_port,\nvsl_eta_next_port,\nvsl_eta_next_port_loc,\nprev_exp_ref,\nnext_exp_ref,\ncreated_on_date,\nvoy_series,\nberth,\narrival_fo,\narrival_do,\narrival_go,\ndeparture_fo,\ndeparture_do,\ndeparture_go,\netb_local,\ncall_status,\nport_days,\nis_cancelled,\nvia_canal,\nspeed,\nvessel_speed,\nmiles,\nmiles_c,\nmiles_mod,\nb_l,\neta_local,\nvessel_eta,\nvessel_eta_local,\netd_local,\nvessel_etd,\nvessel_etd_local,\netb,\netb_lock,\nlaydays,\ncancelling,\nlaydays_local,\ncancelling_local,\ndc,\nwait_port_days,\nidle_port_days,\nextra_port_days,\noffhire_port_days,\nsea_days,\nextra_sea_days,\nstem_ifo,\nstem_mdo,\nstem_go,\nsupplied_ifo,\nsupplied_mdo,\nsupplied_go,\nvsl_arrival_fo,\nvsl_arrival_do,\nvsl_arrival_go,\nvsl_departure_fo,\nvsl_departure_do,\nvsl_departure_go,\nfo_cons_ballast,\ndo_cons_ballast,\nfo_cons_laden,\ndo_cons_laden,\nfo_cons_cargo,\ndo_cons_cargo,\nfo_cons_idle,\ndo_cons_idle,\ngear_working_flag,\nport_expenses,\nc_agents_tel,\nc_agents_fax,\nc_agents_tlx,\nc_agents_contact_mob_tel,\nsubagent_tel,\nsubagent_fax,\nsubagent_tlx,\nsubagent_contact_mob_tel,\nmarine_actions,\ncrewing_actions,\naccounting_actions,\nsupplies_actions,\nagent_relation,\nremarks,\npublish_to_vpr,\nclaims_notes_date,\nclaims_notes_user_id,\nleg_speed,\nslops_rob_unit,\ncrew_changes,\nlaycan_date_local,\ncancel_date_local,\nstem_date,\nstem_supplier,\nstem_suplier_aoh_tel,\nstem_broker,\nstem_broker_aoh_tel,\nsupplied_date,\ninvoice_date,\ninvoice_no,\ncargo_type,\narrival_flag,\nterminal,\ncargo_grade,\naction_type,\npob,\nanchor_arr,\nanchor_dep,\nunberthed,\nref_id,\ninvoiced_ifo,\ninvoiced_mdo,\ninvoiced_go,\ncommission_rate,\nest_port_days,\nsubvoy_no,\nseq_no,\ncargo_no,\noptions_prc,\nstowage_factor,\nlift,\nmax_draft,\nsalinity,\nshipper,\nreceiver,\nfo_cons_gear,\ndo_cons_gear,\nfo_cons_not_gear,\ndo_cons_not_gear,\nest_rate_unit,\nest_rate_close,\nest_extra_days,\ndemurrage_rate,\ndispatch_rate,\nfo_price,\ndo_price,\ngo_price,\norder_code,\narrival_date,\ndeparture_date,\nberthed,\nnor,\nco_in_storage,\nso_in_storage,\ngo_in_storage,\nco_in_storage_dep,\nso_in_storage_dep,\ngo_in_storage_dep,\nbp_distinroute,\nbp_route,\nfo_price_local,\ndo_price_local,\nfo_do_currency_local,\nfirst_port_for_period,\nperiod_no,\nprev_voy_id,\nbp_routingsettings,\ndist_origin,\npsc_inspection_requested,\nport_modified_sap,\nport_modified_afsys,\nvsl_arrival_hsfo,\nvsl_arrival_lsfo,\nvsl_arrival_hsdo,\nvsl_arrival_lsdo,\nvsl_departure_hsfo,\nvsl_departure_lsfo,\narrival_hsdo,\nvsl_departure_hsdo,\nvsl_departure_lsdo,\narrival_lsfo,\narrival_lsdo,\narrival_hsfo,\ndeparture_hsfo,\ndeparture_lsfo,\ndeparture_hsdo,\ndeparture_lsdo,\nlsfo_sea_bss,\nlsdo_sea_pct,\nlsfo_sea_pct,\nlsfo_port_pct,\nlsdo_port_pct,\nlsdo_sea_bss,\nlsfo_port_bss,\nport_no,\nsupplied_hsfo,\nsupplied_lsfo,\nsupplied_hsdo,\nsupplied_lsdo,\nlsdo_port_bss,\nshort_charter,\nowners_agents_email1,\ncharterers_agents_email1,\nsubagents_email1,\nsurveyors_email1,\nowner_agent_appointed,\ncharterer_agent_appointed,\nsub_agent_appointed,\nsurveyor_contact,\nsurveyor_contact_tel_aoh,\nsurveyor_tel,\nsurveyor_contact_mob_tel,\nsurveyor_fax,\nsurveyor_tlx,\nsurveyor,\nport_action_det,\ncommence_date,\ncommence_date_local,\ncomplete_date,\ncomplete_date_local,\ndraft_arr_f,\ndraft_arr_a,\ndraft_arr_m,\ndraft_dep_f,\ndraft_dep_a,\ndraft_dep_m,\nvsl_arrival_water,\nvsl_departure_water,\ndirection,\narea_service,\nvoy_cycle,\nterminal_code,\njob_number,\narea_service_version,\ncreated_by_services,\nin_out,\nmatched_with_dp_rp,\nport_action_det_tz,\nowners_agents_code_head,\ncharterers_agents_code_head,\nsubagent_head,\nsurveyor_head,\ncharterer_agent_comments,\nsurveyor_crg,\nsurveyor_contact_crg,\nsurveyor_contact_tel_aoh_crg,\nsurveyor_tel_crg,\nsurveyor_contact_mob_tel_crg,\nsurveyor_fax_crg,\nsurveyor_tlx_crg,\nsurveyor_head_crg,\nsurveyor_oth,\nsurveyor_contact_oth,\nsurveyor_contact_tel_aoh_oth,\nsurveyor_tel_oth,\nsurveyor_contact_mob_tel_oth,\nsurveyor_fax_oth,\nsurveyor_tlx_oth,\nsurveyor_head_oth,\nsurveyors_email1_crg,\nsurveyors_email1_oth,\nshow_pos_own_agent,\nshow_pos_chr_agent,\nshow_pos_subagent,\nctm_curr,\nctm_local_amount,\nctm_book_amount,\nport_name_full,\nberthed_gmt,\nberthed_local,\nunberthed_gmt,\nunberthed_local,\nvirtual_dep,\nvirtual_arr,\nother_head,\nother_contact,\nother_contact_tel_aoh,\nother_tel,\nother_contact_mob_tel,\nother_fax,\nother_tlx,\nother_email1,\nother_appointed,\nother_agent,\nintegration_key,\n_validation_error as validation_error,\nw_source_system,\nw_src_file_name,\nw_refresh_ts,\nw_job_instance_id,\nw_business_dt,\nw_location,\nw_batch_id\nfrom \n${p_epsdl_sri_db}.rej_sri_expected_call"
schema:
  strict_schema_check: false
  schema_derivation_strategy: "source"
  discard: false
  columns: []
target:
  endpoint: "lo_dataanalytics_azuresynapseanalytics"
  properties:
    table: "${p_epsdl_plp_db}.rej_sri_expected_call"
    format_properties:
      write_semantics: "polybase"
      max_str_length: 4000
  operation: "overwrite"
