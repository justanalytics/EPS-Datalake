version: 1
job:
  type: "processing"
  tags:
  - "epsdl_dim"
source:
  endpoint: "lo_delta_tables"
  properties:
    sql: "select\nacc_category_code\n,additional_expenses\n,approved_qty\n,at_location\n,budget_code\n,created_by_vessel\n,deliverd_factor\n,deliverd_group\n,deliverd_id\n,deliverd_qty\n,deliverd_status\n,delivery_abbreviation\n,delivery_code\n,delivery_marked\n,delivery_sorting\n,despatch_comments\n,despatch_reason\n,dn_code\n,document_code\n,export_flag\n,export_seq_number\n,from_location\n,holder_document_code\n,holder_document_line\n,holder_location\n,interface_code\n,invoice_abbreviation\n,invoice_bookvalue\n,invoice_code\n,invoice_currency\n,invoice_factor\n,invoice_final_date\n,invoice_group\n,invoice_id\n,invoice_marked\n,invoice_modified\n,invoice_sorting\n,invoice_status\n,item_abbreviation\n,item_availability\n,item_delivery_comments\n,item_delivery_date\n,item_delivery_evaluation\n,item_expiry_date\n,item_full_desc\n,item_intern_ref\n,item_invoice_selected\n,item_ledger_card\n,item_origin\n,item_ref_code\n,item_serial_no\n,item_short_desc\n,item_status\n,item_subsystem_code\n,item_system_code\n,item_unit_factor\n,item_unit_group\n,item_unit_id\n,landed_status\n,location_no\n,maintenance_link\n,mode_of_supply\n,n_document_code\n,n_document_line\n,office_item_comments\n,order_abbreviation\n,order_code\n,order_currency\n,order_marked\n,order_remarks\n,order_sorting\n,order_supplier\n,order_unit_factor\n,order_unit_group\n,order_unit_id\n,order_vat\n,p_document_code\n,p_document_line\n,parcial\n,proposed_item\n,psoft_data\n,ready_date\n,received_onboard_date\n,req_marked\n,requested_qty\n,requisition_code\n,requisition_location\n,requisition_sorting\n,revised_due_date\n,rob_qty\n,saved_line\n,saved_location\n,storage_place_no\n,supplier_comments\n,surcharges\n,to_location\n,weight\n,order_rate\n,order_qty\n,order_discount\n,order_price\n,invoice_price\n,invoice_rate\n,invoice_discount\n,invoice_qty\n,integration_key\n,null w_x_custom\n,w_job_instance_id\n,w_refresh_ts\n,null as w_curr_rec_flg\n,w_source_system as w_data_src_id\n,w_location\n,w_batch_id\n,null as w_partition\n,'${business_date[0..9]}' as business_date\nfrom ${p_epsdl_sri_db}.sri_supply_items\nwhere w_business_dt='${business_date[0..9]}'"
  additional_columns:
  - name: "w_refresh_ts"
    value: "current_timestamp"
  - name: "business_date"
    value: "'${business_date}'"
  - name: "w_job_instance_id"
    value: "${job_instance_id}"
  - name: "w_batch_id"
    value: "${batch_id}"
  - name: "w_location"
    value: "'ALL'"
  - name: "w_source_system"
    value: "'NSLADMIN'"
target:
  primary_key_columns:
  - "integration_key"
  operation: "merge"
  properties:
    template: "default"
    table: "${p_epsdl_db}.dim_supply_items"
  merge_columns:
  - "acc_category_code"
  - "additional_expenses"
  - "approved_qty"
  - "at_location"
  - "budget_code"
  - "created_by_vessel"
  - "deliverd_factor"
  - "deliverd_group"
  - "deliverd_id"
  - "deliverd_qty"
  - "deliverd_status"
  - "delivery_abbreviation"
  - "delivery_code"
  - "delivery_marked"
  - "delivery_sorting"
  - "despatch_comments"
  - "despatch_reason"
  - "dn_code"
  - "document_code"
  - "export_flag"
  - "export_seq_number"
  - "from_location"
  - "holder_document_code"
  - "holder_document_line"
  - "holder_location"
  - "interface_code"
  - "invoice_abbreviation"
  - "invoice_bookvalue"
  - "invoice_code"
  - "invoice_currency"
  - "invoice_factor"
  - "invoice_final_date"
  - "invoice_group"
  - "invoice_id"
  - "invoice_marked"
  - "invoice_modified"
  - "invoice_sorting"
  - "invoice_status"
  - "item_abbreviation"
  - "item_availability"
  - "item_delivery_comments"
  - "item_delivery_date"
  - "item_delivery_evaluation"
  - "item_expiry_date"
  - "item_full_desc"
  - "item_intern_ref"
  - "item_invoice_selected"
  - "item_ledger_card"
  - "item_origin"
  - "item_ref_code"
  - "item_serial_no"
  - "item_short_desc"
  - "item_status"
  - "item_subsystem_code"
  - "item_system_code"
  - "item_unit_factor"
  - "item_unit_group"
  - "item_unit_id"
  - "landed_status"
  - "location_no"
  - "maintenance_link"
  - "mode_of_supply"
  - "n_document_code"
  - "n_document_line"
  - "office_item_comments"
  - "order_abbreviation"
  - "order_code"
  - "order_currency"
  - "order_marked"
  - "order_remarks"
  - "order_sorting"
  - "order_supplier"
  - "order_unit_factor"
  - "order_unit_group"
  - "order_unit_id"
  - "order_vat"
  - "p_document_code"
  - "p_document_line"
  - "parcial"
  - "proposed_item"
  - "psoft_data"
  - "ready_date"
  - "received_onboard_date"
  - "req_marked"
  - "requested_qty"
  - "requisition_code"
  - "requisition_location"
  - "requisition_sorting"
  - "revised_due_date"
  - "rob_qty"
  - "saved_line"
  - "saved_location"
  - "storage_place_no"
  - "supplier_comments"
  - "surcharges"
  - "to_location"
  - "weight"
  - "working_qty"
  - "order_qty"
  - "order_discount"
  - "order_price"
  endpoint: "lo_delta_tables"
