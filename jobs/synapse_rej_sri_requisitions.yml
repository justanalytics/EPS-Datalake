version: 1
job:
  type: "ingestion"
  tags:
  - "epsdl_plp"
  description: "Sync databricks and synapse"
source:
  endpoint: "lo_delta_tables"
  properties:
    query: "select\nrej_sri_requisitions.vessel_code,\nrej_sri_requisitions.department,\nrej_sri_requisitions.document_code,\nrej_sri_requisitions.document_no,\nrej_sri_requisitions.document_date,\nrej_sri_requisitions.requisition_code,\nrej_sri_requisitions.quotation_code,\nrej_sri_requisitions.order_code,\nrej_sri_requisitions.delivery_code,\nrej_sri_requisitions.invoice_no,\nrej_sri_requisitions.delivery_date,\nrej_sri_requisitions.ships_requisition_no,\nrej_sri_requisitions.requisition_port,\nrej_sri_requisitions.order_port,\nrej_sri_requisitions.delivery_port,\nrej_sri_requisitions.order_due_date,\nrej_sri_requisitions.requisition_eta,\nrej_sri_requisitions.requisition_etd,\nrej_sri_requisitions.voyage_id,\nrej_sri_requisitions.voyage_number,\nrej_sri_requisitions.protected,\nrej_sri_requisitions.quotation_supplier,\nrej_sri_requisitions.total_items,\nrej_sri_requisitions.line_type,\nrej_sri_requisitions.order_supplier,\nrej_sri_requisitions.order_agent,\nrej_sri_requisitions.comments,\nrej_sri_requisitions.entry_unit_type,\nrej_sri_requisitions.user,\nrej_sri_requisitions.approver,\nrej_sri_requisitions.verifier,\nrej_sri_requisitions.currency,\nrej_sri_requisitions.reference,\nrej_sri_requisitions.additional_items,\nrej_sri_requisitions.additional_price,\nrej_sri_requisitions.journal_reference,\nrej_sri_requisitions.tarriff_agreed,\nrej_sri_requisitions.part_deliveries,\nrej_sri_requisitions.user_1,\nrej_sri_requisitions.user_2,\nrej_sri_requisitions.user_3,\nrej_sri_requisitions.user_4,\nrej_sri_requisitions.tariff_agreed,\nrej_sri_requisitions.extra_comments,\nrej_sri_requisitions.total_add_expenses,\nrej_sri_requisitions.dispatch_vessel_code,\nrej_sri_requisitions.dispatch_department_code,\nrej_sri_requisitions.dispatch_line,\nrej_sri_requisitions.requisition_raised_date,\nrej_sri_requisitions.dn_code,\nrej_sri_requisitions.urgency_code,\nrej_sri_requisitions.invoice_supplier,\nrej_sri_requisitions.supplier_location,\nrej_sri_requisitions.period_required,\nrej_sri_requisitions.terms,\nrej_sri_requisitions.approver2,\nrej_sri_requisitions.payment_terms,\nrej_sri_requisitions.tariff_agreed_date,\nrej_sri_requisitions.commercial_contract,\nrej_sri_requisitions.commercial_contract_date,\nrej_sri_requisitions.supplier_reminder,\nrej_sri_requisitions.disputed_flag,\nrej_sri_requisitions.budget_code,\nrej_sri_requisitions.sent_to,\nrej_sri_requisitions.warehouse_code,\nrej_sri_requisitions.warehouse_supplier,\nrej_sri_requisitions.delivery_to,\nrej_sri_requisitions.maintenance_link,\nrej_sri_requisitions.user_5,\nrej_sri_requisitions.issued_by,\nrej_sri_requisitions.prepare_direct,\nrej_sri_requisitions.disputed_date,\nrej_sri_requisitions.approved_flag,\nrej_sri_requisitions.approved_date,\nrej_sri_requisitions.sent_for_approval,\nrej_sri_requisitions.sent_for_approval_date,\nrej_sri_requisitions.disputed_comments,\nrej_sri_requisitions.approved_comments,\nrej_sri_requisitions.buyer_comments,\nrej_sri_requisitions.supplier_name,\nrej_sri_requisitions.accounting_flag,\nrej_sri_requisitions.created_by_vessel,\nrej_sri_requisitions.delivery_confirmation_date,\nrej_sri_requisitions.acc_category_code,\nrej_sri_requisitions.document_source,\nrej_sri_requisitions.delivery_confirmation,\nrej_sri_requisitions.vendor_location,\nrej_sri_requisitions.acc_process_flag,\nrej_sri_requisitions.forwarding_instructions,\nrej_sri_requisitions.print_option,\nrej_sri_requisitions.date_imported,\nrej_sri_requisitions.spc_category_code,\nrej_sri_requisitions.discount,\nrej_sri_requisitions.exchange_rate_flag,\nrej_sri_requisitions.previous_exchange_rate,\nrej_sri_requisitions.order_date,\nrej_sri_requisitions.accrual_reference,\nrej_sri_requisitions.requisition_description,\nrej_sri_requisitions.supplier_reminder_no,\nrej_sri_requisitions.import_flag,\nrej_sri_requisitions.quotation_comments,\nrej_sri_requisitions.integration_key,\nrej_sri_requisitions._validation_error as validation_error,\nrej_sri_requisitions.w_source_system,\nrej_sri_requisitions.w_src_file_name,\nrej_sri_requisitions.w_refresh_ts,\nrej_sri_requisitions.w_job_instance_id,\nrej_sri_requisitions.w_business_dt,\nrej_sri_requisitions.w_location,\nrej_sri_requisitions.w_batch_id\nfrom ${p_epsdl_sri_db}.rej_sri_requisitions rej_sri_requisitions"
schema:
  strict_schema_check: false
  schema_derivation_strategy: "source"
  discard: false
  columns: []
target:
  endpoint: "lo_dataanalytics_azuresynapseanalytics"
  properties:
    table: "${p_epsdl_plp_db}.rej_sri_requisitions"
    format_properties:
      write_semantics: "polybase"
      max_str_length: 4000
  operation: "overwrite"
