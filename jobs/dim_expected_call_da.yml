version: 1
job:
  type: "processing"
  tags:
  - "epsdl_dim"
source:
  endpoint: "lo_delta_tables"
  properties:
    sql: "select \naction\n,agent_code\n,agent_relation\n,attachment_code\n,berth\n,cargo\n,case_status\n,category\n,checked_by_user\n,checked_date\n,credit_days\n,currency\n,da_comments\n,da_no\n,eta\n,exp_ref\n,final_journal_company\n,final_journal_date\n,final_journal_number\n,final_journal_series\n,given_date\n,initial_internal_ref\n,initial_journal_company\n,initial_journal_date\n,initial_journal_number\n,initial_journal_series\n,internal_ref\n,invoice_date\n,is_general_da\n,item_remarks\n,matching_company\n,matching_journal_line\n,matching_number\n,matching_series\n,payment_method\n,port_name\n,rate\n,rate_flag\n,received_by_user\n,received_date\n,second_journal_company\n,second_journal_date\n,second_journal_number\n,second_journal_series\n,sent_to_diabos\n,serial_no\n,third_journal_company\n,third_journal_date\n,third_journal_number\n,third_journal_series\n,update_date\n,update_user_id\n,vessel_code\n,voyage_number\n,integration_key\n,null as w_x_custom\n,w_job_instance_id\n,w_refresh_ts\n,null as w_curr_rec_flg\n,w_source_system as w_data_src_id\n,w_location\n,w_batch_id\n,'${business_date[0..9]}' as business_date\nfrom ${p_epsdl_sri_db}.sri_expected_call_da\nwhere w_business_dt='${business_date[0..9]}'"
  additional_columns:
  - name: "w_refresh_ts"
    value: "current_timestamp"
  - name: "business_date"
    value: "'${business_date}'"
  - name: "w_job_instance_id"
    value: "${job_instance_id}"
  - name: "w_batch_id"
    value: "${batch_id}"
  - name: "w_location"
    value: "'ALL'"
  - name: "w_source_system"
    value: "'DANAOS'"
target:
  primary_key_columns:
  - "integration_key"
  operation: "merge"
  properties:
    template: "default"
    table: "${p_epsdl_db}.dim_expected_call_da"
  merge_columns:
  - "action"
  - "agent_code"
  - "agent_relation"
  - "attachment_code"
  - "berth"
  - "cargo"
  - "case_status"
  - "category"
  - "checked_by_user"
  - "checked_date"
  - "credit_days"
  - "currency"
  - "da_comments"
  - "da_no"
  - "eta"
  - "exp_ref"
  - "final_journal_company"
  - "final_journal_date"
  - "final_journal_number"
  - "final_journal_series"
  - "given_date"
  - "initial_internal_ref"
  - "initial_journal_company"
  - "initial_journal_date"
  - "initial_journal_number"
  - "initial_journal_series"
  - "internal_ref"
  - "invoice_date"
  - "is_general_da"
  - "item_remarks"
  - "matching_company"
  - "matching_journal_line"
  - "matching_number"
  - "matching_series"
  - "payment_method"
  - "port_name"
  - "rate"
  - "rate_flag"
  - "received_by_user"
  - "received_date"
  - "second_journal_company"
  - "second_journal_date"
  - "second_journal_number"
  - "second_journal_series"
  - "sent_to_diabos"
  - "serial_no"
  - "third_journal_company"
  - "third_journal_date"
  - "third_journal_number"
  - "third_journal_series"
  - "update_date"
  - "update_user_id"
  - "vessel_code"
  - "voyage_number"
  endpoint: "lo_delta_tables"
